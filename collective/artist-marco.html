<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Marco Oliveira — Film Noir Prints | COLECTIVO</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=IBM+Plex+Mono:wght@300;400;500&display=swap" rel="stylesheet">
<style>
*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

:root {
  --bg: #0d0d0d;
  --fg: #e8e4df;
  --accent: #d4442a;
  --dim: #5a5550;
  --card-bg: #151413;
  --border: rgba(232, 228, 223, 0.08);
  --display: 'Bebas Neue', Impact, sans-serif;
  --mono: 'IBM Plex Mono', 'Courier New', monospace;
}

html { font-size: 100%; scroll-behavior: smooth; }

body {
  background: var(--bg);
  color: var(--fg);
  font-family: var(--mono);
  line-height: 1.6;
  overflow-x: hidden;
  position: relative;
}

/* Film grain overlay */
body::after {
  content: '';
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 9999;
  opacity: 0.06;
  background: url("data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='5' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
  animation: grainShift 0.5s steps(3) infinite;
}

@keyframes grainShift {
  0% { transform: translate(0, 0); }
  33% { transform: translate(-0.5rem, 0.5rem); }
  66% { transform: translate(0.5rem, -0.25rem); }
  100% { transform: translate(0, 0); }
}

/* NAV */
nav {
  position: fixed;
  top: 0; left: 0; right: 0;
  z-index: 100;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: clamp(1rem, 2vw, 1.5rem) clamp(1.5rem, 5vw, 4rem);
  background: rgba(13, 13, 13, 0.9);
  backdrop-filter: blur(1.5rem);
  border-bottom: 0.0625rem solid var(--border);
}

.nav-logo {
  font-family: var(--display);
  font-size: clamp(1.25rem, 2.5vw, 1.75rem);
  letter-spacing: 0.15em;
  color: var(--fg);
  text-decoration: none;
}

.nav-links {
  display: flex;
  gap: clamp(1.25rem, 3vw, 2.5rem);
  list-style: none;
}

.nav-links a {
  color: var(--dim);
  text-decoration: none;
  font-size: clamp(0.65rem, 1vw, 0.8rem);
  letter-spacing: 0.15em;
  text-transform: uppercase;
  transition: color 0.3s;
}

.nav-links a:hover { color: var(--accent); }

.nav-burger {
  display: none;
  flex-direction: column;
  gap: 0.35rem;
  background: none;
  border: none;
  cursor: pointer;
  padding: 0.5rem;
}

.nav-burger span {
  display: block;
  width: 1.5rem;
  height: 0.1rem;
  background: var(--fg);
  transition: transform 0.3s, opacity 0.3s;
}

.nav-burger.active span:nth-child(1) { transform: translateY(0.45rem) rotate(45deg); }
.nav-burger.active span:nth-child(2) { opacity: 0; }
.nav-burger.active span:nth-child(3) { transform: translateY(-0.45rem) rotate(-45deg); }

.mobile-menu {
  display: none;
  position: fixed;
  inset: 0;
  z-index: 99;
  background: rgba(13, 13, 13, 0.98);
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 2rem;
}

.mobile-menu.active { display: flex; }

.mobile-menu a {
  color: var(--fg);
  text-decoration: none;
  font-family: var(--display);
  font-size: clamp(2rem, 8vw, 4rem);
  letter-spacing: 0.1em;
}

@media (max-width: 48em) {
  .nav-links { display: none; }
  .nav-burger { display: flex; }
}

/* HERO */
.hero {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: flex-start;
  padding: clamp(6rem, 12vw, 10rem) clamp(1.5rem, 5vw, 4rem);
  position: relative;
}

.hero::before {
  content: '';
  position: absolute;
  top: 0; right: 0;
  width: 60%;
  height: 100%;
  background: linear-gradient(to left, rgba(212, 68, 42, 0.03), transparent);
  pointer-events: none;
}

.hero h1 {
  font-family: var(--display);
  font-size: clamp(4rem, 15vw, 12rem);
  line-height: 0.85;
  letter-spacing: 0.05em;
  color: var(--fg);
}

.hero h1 .accent { color: var(--accent); }

.hero-meta {
  margin-top: clamp(1.5rem, 3vw, 2rem);
  font-size: clamp(0.7rem, 1vw, 0.8rem);
  color: var(--dim);
  letter-spacing: 0.2em;
  text-transform: uppercase;
  display: flex;
  flex-wrap: wrap;
  gap: 1.5rem;
}

.hero-meta span::before {
  content: '//';
  color: var(--accent);
  margin-right: 0.5rem;
}

.hero-bio {
  margin-top: clamp(1.5rem, 3vw, 2.5rem);
  font-size: clamp(0.85rem, 1.3vw, 1rem);
  color: var(--dim);
  max-width: 35em;
  line-height: 1.8;
  font-weight: 300;
}

/* SECTION DIVIDER */
.divider {
  padding: 0 clamp(1.5rem, 5vw, 4rem);
}

.divider-line {
  height: 0.0625rem;
  background: var(--border);
  position: relative;
}

.divider-line::before {
  content: attr(data-label);
  position: absolute;
  left: 0;
  top: 50%;
  transform: translateY(-50%);
  background: var(--bg);
  padding-right: 1rem;
  font-size: 0.65rem;
  letter-spacing: 0.25em;
  text-transform: uppercase;
  color: var(--dim);
}

/* CART DROP ZONE */
.cart-zone {
  position: fixed;
  bottom: clamp(1rem, 3vw, 2rem);
  right: clamp(1rem, 3vw, 2rem);
  z-index: 50;
  background: var(--card-bg);
  border: 0.125rem dashed var(--border);
  border-radius: 0.5rem;
  padding: clamp(0.75rem, 1.5vw, 1rem) clamp(1rem, 2vw, 1.5rem);
  min-width: clamp(12rem, 20vw, 16rem);
  transition: border-color 0.3s, background 0.3s, transform 0.3s;
  cursor: default;
}

.cart-zone.drag-over {
  border-color: var(--accent);
  background: rgba(212, 68, 42, 0.08);
  transform: scale(1.03);
}

.cart-zone-header {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  margin-bottom: 0.5rem;
  font-size: clamp(0.65rem, 1vw, 0.75rem);
  letter-spacing: 0.15em;
  text-transform: uppercase;
  color: var(--dim);
}

.cart-zone-header .cart-icon {
  font-size: 1.1em;
}

.cart-items {
  display: flex;
  flex-direction: column;
  gap: 0.35rem;
  max-height: 10rem;
  overflow-y: auto;
}

.cart-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: clamp(0.65rem, 0.9vw, 0.75rem);
  padding: 0.35em 0;
  border-bottom: 0.0625rem solid var(--border);
  animation: cartItemIn 0.3s ease;
}

@keyframes cartItemIn {
  from { opacity: 0; transform: translateX(0.5rem); }
  to { opacity: 1; transform: translateX(0); }
}

.cart-item-remove {
  background: none;
  border: none;
  color: var(--accent);
  cursor: pointer;
  font-size: 0.8rem;
  padding: 0.2em;
  transition: opacity 0.2s;
}

.cart-item-remove:hover { opacity: 0.6; }

.cart-total {
  margin-top: 0.5rem;
  padding-top: 0.5rem;
  border-top: 0.0625rem solid var(--border);
  display: flex;
  justify-content: space-between;
  font-size: clamp(0.7rem, 1vw, 0.8rem);
  font-weight: 500;
}

.cart-checkout {
  margin-top: 0.75rem;
  width: 100%;
  padding: 0.6em;
  background: var(--accent);
  color: var(--fg);
  border: none;
  font-family: var(--mono);
  font-size: clamp(0.6rem, 0.9vw, 0.7rem);
  letter-spacing: 0.15em;
  text-transform: uppercase;
  cursor: pointer;
  transition: opacity 0.3s;
  border-radius: 0.15rem;
}

.cart-checkout:hover { opacity: 0.85; }

.cart-empty {
  font-size: clamp(0.6rem, 0.9vw, 0.7rem);
  color: var(--dim);
  text-align: center;
  padding: 0.5rem 0;
}

/* PRINTS GRID */
.prints-section {
  padding: clamp(4rem, 8vw, 6rem) clamp(1.5rem, 5vw, 4rem);
}

.prints-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(min(16rem, 100%), 1fr));
  gap: clamp(1.25rem, 2.5vw, 2rem);
}

.print-card {
  background: var(--card-bg);
  border: 0.0625rem solid var(--border);
  border-radius: 0.25rem;
  overflow: hidden;
  cursor: grab;
  transition: border-color 0.3s, transform 0.3s, box-shadow 0.3s;
  user-select: none;
  -webkit-user-select: none;
}

.print-card:active { cursor: grabbing; }

.print-card:hover {
  border-color: rgba(212, 68, 42, 0.3);
  transform: translateY(-0.15rem);
}

.print-card.dragging {
  opacity: 0.5;
  transform: scale(0.95);
  border-color: var(--accent);
}

.print-card-img {
  width: 100%;
  aspect-ratio: 4/5;
  background: linear-gradient(135deg, #1a1816, #252220);
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--dim);
  font-size: 0.7rem;
  letter-spacing: 0.1em;
  text-transform: uppercase;
  position: relative;
  overflow: hidden;
}

.print-card-img::after {
  content: '';
  position: absolute;
  inset: 0;
  border: 0.5rem solid var(--card-bg);
  pointer-events: none;
}

.drag-hint {
  position: absolute;
  bottom: 0.75rem;
  right: 0.75rem;
  font-size: 0.6rem;
  color: var(--dim);
  background: rgba(13, 13, 13, 0.8);
  padding: 0.25em 0.5em;
  border-radius: 0.15rem;
  opacity: 0;
  transition: opacity 0.3s;
  letter-spacing: 0.1em;
  text-transform: uppercase;
}

.print-card:hover .drag-hint { opacity: 1; }

.print-card-info {
  padding: clamp(1rem, 2vw, 1.25rem);
}

.print-card-title {
  font-family: var(--display);
  font-size: clamp(1.1rem, 2vw, 1.4rem);
  letter-spacing: 0.05em;
  margin-bottom: 0.15rem;
}

.print-card-meta {
  font-size: clamp(0.6rem, 0.9vw, 0.7rem);
  color: var(--dim);
  letter-spacing: 0.1em;
  text-transform: uppercase;
  margin-bottom: 0.75rem;
}

.print-card-bottom {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.print-card-price {
  font-size: clamp(0.9rem, 1.5vw, 1.1rem);
  font-weight: 500;
  color: var(--accent);
}

.print-card-btn {
  background: none;
  border: 0.0625rem solid var(--border);
  color: var(--fg);
  font-family: var(--mono);
  font-size: clamp(0.55rem, 0.8vw, 0.65rem);
  letter-spacing: 0.15em;
  text-transform: uppercase;
  padding: 0.5em 1em;
  cursor: pointer;
  transition: border-color 0.3s, background 0.3s;
  border-radius: 0.15rem;
}

.print-card-btn:hover {
  border-color: var(--accent);
  background: rgba(212, 68, 42, 0.1);
}

/* MOBILE CART TOGGLE */
.cart-toggle-mobile {
  display: none;
  position: fixed;
  bottom: clamp(1rem, 3vw, 2rem);
  right: clamp(1rem, 3vw, 2rem);
  z-index: 51;
  width: 3rem;
  height: 3rem;
  border-radius: 50%;
  background: var(--accent);
  border: none;
  color: var(--fg);
  font-size: 1.2rem;
  cursor: pointer;
  box-shadow: 0 0.25rem 1rem rgba(0,0,0,0.5);
}

.cart-badge {
  position: absolute;
  top: -0.25rem;
  right: -0.25rem;
  background: var(--fg);
  color: var(--bg);
  font-size: 0.6rem;
  width: 1.2em;
  height: 1.2em;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: var(--mono);
  font-weight: 700;
}

@media (max-width: 48em) {
  .cart-zone { 
    display: none;
    bottom: 4.5rem;
    right: 0.75rem;
    left: 0.75rem;
    min-width: auto;
  }
  .cart-zone.mobile-open { display: block; }
  .cart-toggle-mobile { display: flex; align-items: center; justify-content: center; }
}

/* ABOUT SECTION */
.about-section {
  padding: clamp(4rem, 8vw, 6rem) clamp(1.5rem, 5vw, 4rem);
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(min(20rem, 100%), 1fr));
  gap: clamp(2rem, 4vw, 4rem);
  align-items: start;
}

.about-text h2 {
  font-family: var(--display);
  font-size: clamp(2rem, 5vw, 3.5rem);
  letter-spacing: 0.05em;
  margin-bottom: clamp(1rem, 2vw, 1.5rem);
}

.about-text p {
  font-size: clamp(0.8rem, 1.2vw, 0.9rem);
  color: var(--dim);
  line-height: 1.8;
  margin-bottom: 1rem;
  font-weight: 300;
}

.gear-list {
  list-style: none;
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.gear-list li {
  font-size: clamp(0.7rem, 1vw, 0.8rem);
  color: var(--dim);
  padding-left: 1.5em;
  position: relative;
}

.gear-list li::before {
  content: '›';
  position: absolute;
  left: 0;
  color: var(--accent);
  font-weight: 700;
}

/* FOOTER */
footer {
  border-top: 0.0625rem solid var(--border);
  padding: clamp(2rem, 4vw, 3rem) clamp(1.5rem, 5vw, 4rem);
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  gap: 1rem;
}

footer span {
  font-size: 0.7rem;
  color: var(--dim);
  letter-spacing: 0.1em;
}

.footer-links {
  display: flex;
  gap: 1.5rem;
  list-style: none;
}

.footer-links a {
  font-size: 0.7rem;
  color: var(--dim);
  text-decoration: none;
  letter-spacing: 0.1em;
  transition: color 0.3s;
}

.footer-links a:hover { color: var(--accent); }

/* REVEAL ANIMATION */
.reveal {
  opacity: 0;
  transform: translateY(1.5rem);
  transition: opacity 0.8s ease, transform 0.8s ease;
}

.reveal.visible {
  opacity: 1;
  transform: translateY(0);
}

/* Touch drag ghost */
.touch-ghost {
  position: fixed;
  z-index: 200;
  pointer-events: none;
  opacity: 0.85;
  transform: rotate(-2deg) scale(0.6);
  background: var(--card-bg);
  border: 0.125rem solid var(--accent);
  border-radius: 0.25rem;
  padding: 0.5rem 0.75rem;
  font-family: var(--mono);
  font-size: 0.7rem;
  color: var(--fg);
  white-space: nowrap;
  box-shadow: 0 0.5rem 2rem rgba(0,0,0,0.6);
}
</style>
</head>
<body>

<!-- NAV -->
<nav>
  <a href="index.html" class="nav-logo">COLECTIVO</a>
  <ul class="nav-links">
    <li><a href="index.html">Home</a></li>
    <li><a href="artist-luna.html">Luna</a></li>
    <li><a href="services.html">Services</a></li>
    <li><a href="store.html">Store</a></li>
  </ul>
  <button class="nav-burger" aria-label="Menu">
    <span></span><span></span><span></span>
  </button>
</nav>

<div class="mobile-menu">
  <a href="index.html">Home</a>
  <a href="artist-luna.html">Luna</a>
  <a href="services.html">Services</a>
  <a href="store.html">Store</a>
</div>

<!-- HERO -->
<section class="hero">
  <h1>MARCO<br><span class="accent">OLIVEIRA</span></h1>
  <div class="hero-meta">
    <span>Lisbon, PT</span>
    <span>Leica M6</span>
    <span>Tri-X 400</span>
  </div>
  <p class="hero-bio">Streets at midnight. Light bleeding through fog. The quiet tension between shadow and the unknown. Every frame is a fragment of a story you walked past.</p>
</section>

<!-- DIVIDER -->
<div class="divider">
  <div class="divider-line" data-label="Available Prints"></div>
</div>

<!-- CART DROP ZONE -->
<div class="cart-zone" id="cartZone">
  <div class="cart-zone-header">
    <span class="cart-icon">◫</span>
    <span>Drop prints here</span>
  </div>
  <div class="cart-items" id="cartItems">
    <div class="cart-empty">Drag a print to add it</div>
  </div>
  <div class="cart-total" id="cartTotal" style="display:none;">
    <span>Total</span>
    <span id="cartTotalValue">€0</span>
  </div>
  <button class="cart-checkout" id="cartCheckout" style="display:none;">
    Checkout via Stripe →
  </button>
</div>

<button class="cart-toggle-mobile" id="cartToggle">
  ◫
  <span class="cart-badge" id="cartBadge" style="display:none;">0</span>
</button>

<!-- PRINTS -->
<section class="prints-section">
  <div class="prints-grid" id="printsGrid">

    <div class="print-card reveal" draggable="true" data-id="m1" data-title="Alfama Midnight" data-price="45">
      <div class="print-card-img">
        Alfama Midnight
        <span class="drag-hint">⤱ Drag to cart</span>
      </div>
      <div class="print-card-info">
        <div class="print-card-title">ALFAMA MIDNIGHT</div>
        <div class="print-card-meta">35mm · Tri-X 400 · Silver Gelatin</div>
        <div class="print-card-bottom">
          <span class="print-card-price">€45</span>
          <button class="print-card-btn" data-id="m1">Add to cart</button>
        </div>
      </div>
    </div>

    <div class="print-card reveal" draggable="true" data-id="m2" data-title="Tram 28 Ghosts" data-price="50">
      <div class="print-card-img">
        Tram 28 Ghosts
        <span class="drag-hint">⤱ Drag to cart</span>
      </div>
      <div class="print-card-info">
        <div class="print-card-title">TRAM 28 GHOSTS</div>
        <div class="print-card-meta">35mm · Tri-X 400 · Silver Gelatin</div>
        <div class="print-card-bottom">
          <span class="print-card-price">€50</span>
          <button class="print-card-btn" data-id="m2">Add to cart</button>
        </div>
      </div>
    </div>

    <div class="print-card reveal" draggable="true" data-id="m3" data-title="Bairro Alto Rain" data-price="40">
      <div class="print-card-img">
        Bairro Alto Rain
        <span class="drag-hint">⤱ Drag to cart</span>
      </div>
      <div class="print-card-info">
        <div class="print-card-title">BAIRRO ALTO RAIN</div>
        <div class="print-card-meta">35mm · HP5+ · Silver Gelatin</div>
        <div class="print-card-bottom">
          <span class="print-card-price">€40</span>
          <button class="print-card-btn" data-id="m3">Add to cart</button>
        </div>
      </div>
    </div>

    <div class="print-card reveal" draggable="true" data-id="m4" data-title="Ponte 25 Fog" data-price="55">
      <div class="print-card-img">
        Ponte 25 Fog
        <span class="drag-hint">⤱ Drag to cart</span>
      </div>
      <div class="print-card-info">
        <div class="print-card-title">PONTE 25 FOG</div>
        <div class="print-card-meta">35mm · Tri-X 400 · Silver Gelatin</div>
        <div class="print-card-bottom">
          <span class="print-card-price">€55</span>
          <button class="print-card-btn" data-id="m4">Add to cart</button>
        </div>
      </div>
    </div>

    <div class="print-card reveal" draggable="true" data-id="m5" data-title="LX Factory Shadows" data-price="45">
      <div class="print-card-img">
        LX Factory Shadows
        <span class="drag-hint">⤱ Drag to cart</span>
      </div>
      <div class="print-card-info">
        <div class="print-card-title">LX FACTORY SHADOWS</div>
        <div class="print-card-meta">35mm · Tri-X 400 · Silver Gelatin</div>
        <div class="print-card-bottom">
          <span class="print-card-price">€45</span>
          <button class="print-card-btn" data-id="m5">Add to cart</button>
        </div>
      </div>
    </div>

    <div class="print-card reveal" draggable="true" data-id="m6" data-title="Mouraria Stairs" data-price="50">
      <div class="print-card-img">
        Mouraria Stairs
        <span class="drag-hint">⤱ Drag to cart</span>
      </div>
      <div class="print-card-info">
        <div class="print-card-title">MOURARIA STAIRS</div>
        <div class="print-card-meta">35mm · HP5+ · Silver Gelatin</div>
        <div class="print-card-bottom">
          <span class="print-card-price">€50</span>
          <button class="print-card-btn" data-id="m6">Add to cart</button>
        </div>
      </div>
    </div>

  </div>
</section>

<!-- ABOUT MARCO -->
<div class="divider">
  <div class="divider-line" data-label="About"></div>
</div>

<section class="about-section">
  <div class="about-text reveal">
    <h2>ABOUT MARCO</h2>
    <p>Born and raised in Lisbon. Started shooting on a stolen Olympus OM-1 at 16. Moved to a Leica M6 and never looked back. The streets are his studio — the darker, the better.</p>
    <p>All prints are hand-developed and printed on fiber-based silver gelatin paper in a home darkroom in Alfama. Limited editions of 15 per image. Signed and numbered.</p>
  </div>
  <div class="reveal">
    <h2 style="font-family:var(--display);font-size:clamp(1.2rem,2vw,1.5rem);letter-spacing:0.05em;margin-bottom:1rem;">GEAR</h2>
    <ul class="gear-list">
      <li>Leica M6 Classic</li>
      <li>Voigtländer 35mm f/1.4</li>
      <li>Leica Summicron 50mm f/2</li>
      <li>Kodak Tri-X 400</li>
      <li>Ilford HP5 Plus</li>
      <li>Ilford Multigrade RC Paper</li>
    </ul>
  </div>
</section>

<!-- FOOTER -->
<footer>
  <span>© 2026 Marco Oliveira / Colectivo</span>
  <ul class="footer-links">
    <li><a href="index.html">Home</a></li>
    <li><a href="privacy.html">Privacy</a></li>
    <li><a href="https://instagram.com" target="_blank">IG</a></li>
  </ul>
</footer>

<script>
// Mobile nav
const burger = document.querySelector('.nav-burger');
const mobileMenu = document.querySelector('.mobile-menu');
burger.addEventListener('click', () => {
  burger.classList.toggle('active');
  mobileMenu.classList.toggle('active');
  document.body.style.overflow = mobileMenu.classList.contains('active') ? 'hidden' : '';
});
mobileMenu.querySelectorAll('a').forEach(a => a.addEventListener('click', () => {
  burger.classList.remove('active');
  mobileMenu.classList.remove('active');
  document.body.style.overflow = '';
}));

// Scroll reveal
const obs = new IntersectionObserver(entries => {
  entries.forEach(e => { if (e.isIntersecting) e.target.classList.add('visible'); });
}, { threshold: 0.1 });
document.querySelectorAll('.reveal').forEach(el => obs.observe(el));

// ===== CART SYSTEM =====
const cart = [];
const cartZone = document.getElementById('cartZone');
const cartItems = document.getElementById('cartItems');
const cartTotal = document.getElementById('cartTotal');
const cartTotalValue = document.getElementById('cartTotalValue');
const cartCheckout = document.getElementById('cartCheckout');
const cartToggle = document.getElementById('cartToggle');
const cartBadge = document.getElementById('cartBadge');

function addToCart(id, title, price) {
  if (cart.find(i => i.id === id)) return;
  cart.push({ id, title, price: parseFloat(price) });
  renderCart();
}

function removeFromCart(id) {
  const idx = cart.findIndex(i => i.id === id);
  if (idx > -1) cart.splice(idx, 1);
  renderCart();
}

function renderCart() {
  if (cart.length === 0) {
    cartItems.innerHTML = '<div class="cart-empty">Drag a print to add it</div>';
    cartTotal.style.display = 'none';
    cartCheckout.style.display = 'none';
    cartBadge.style.display = 'none';
  } else {
    cartItems.innerHTML = cart.map(item => `
      <div class="cart-item">
        <span>${item.title}</span>
        <span>€${item.price}</span>
        <button class="cart-item-remove" onclick="removeFromCart('${item.id}')">✕</button>
      </div>
    `).join('');
    const total = cart.reduce((s, i) => s + i.price, 0);
    cartTotalValue.textContent = '€' + total;
    cartTotal.style.display = 'flex';
    cartCheckout.style.display = 'block';
    cartBadge.style.display = 'flex';
    cartBadge.textContent = cart.length;
  }
}

// Desktop drag & drop
document.querySelectorAll('.print-card').forEach(card => {
  card.addEventListener('dragstart', e => {
    card.classList.add('dragging');
    e.dataTransfer.setData('text/plain', JSON.stringify({
      id: card.dataset.id,
      title: card.dataset.title,
      price: card.dataset.price
    }));
    e.dataTransfer.effectAllowed = 'copy';
  });

  card.addEventListener('dragend', () => {
    card.classList.remove('dragging');
  });
});

cartZone.addEventListener('dragover', e => {
  e.preventDefault();
  e.dataTransfer.dropEffect = 'copy';
  cartZone.classList.add('drag-over');
});

cartZone.addEventListener('dragleave', () => {
  cartZone.classList.remove('drag-over');
});

cartZone.addEventListener('drop', e => {
  e.preventDefault();
  cartZone.classList.remove('drag-over');
  try {
    const data = JSON.parse(e.dataTransfer.getData('text/plain'));
    addToCart(data.id, data.title, data.price);
  } catch(err) {}
});

// Touch drag & drop (mobile)
let touchDragData = null;
let touchGhost = null;

document.querySelectorAll('.print-card').forEach(card => {
  card.addEventListener('touchstart', e => {
    const touch = e.touches[0];
    touchDragData = {
      id: card.dataset.id,
      title: card.dataset.title,
      price: card.dataset.price,
      startX: touch.clientX,
      startY: touch.clientY,
      dragging: false
    };
  }, { passive: true });

  card.addEventListener('touchmove', e => {
    if (!touchDragData) return;
    const touch = e.touches[0];
    const dx = Math.abs(touch.clientX - touchDragData.startX);
    const dy = Math.abs(touch.clientY - touchDragData.startY);

    if (!touchDragData.dragging && (dx > 10 || dy > 10)) {
      touchDragData.dragging = true;
      card.classList.add('dragging');
      touchGhost = document.createElement('div');
      touchGhost.className = 'touch-ghost';
      touchGhost.textContent = touchDragData.title;
      document.body.appendChild(touchGhost);
    }

    if (touchDragData.dragging) {
      e.preventDefault();
      touchGhost.style.left = touch.clientX / 16 + 'rem';
      touchGhost.style.top = (touch.clientY / 16 - 2) + 'rem';

      const cartRect = cartZone.getBoundingClientRect();
      const overCart = touch.clientX >= cartRect.left && touch.clientX <= cartRect.right &&
                       touch.clientY >= cartRect.top && touch.clientY <= cartRect.bottom;
      cartZone.classList.toggle('drag-over', overCart);
    }
  }, { passive: false });

  card.addEventListener('touchend', e => {
    if (!touchDragData) return;
    card.classList.remove('dragging');

    if (touchDragData.dragging) {
      const touch = e.changedTouches[0];
      const cartRect = cartZone.getBoundingClientRect();
      const overCart = touch.clientX >= cartRect.left && touch.clientX <= cartRect.right &&
                       touch.clientY >= cartRect.top && touch.clientY <= cartRect.bottom;
      if (overCart) {
        addToCart(touchDragData.id, touchDragData.title, touchDragData.price);
      }
      cartZone.classList.remove('drag-over');
      if (touchGhost) { touchGhost.remove(); touchGhost = null; }
    }
    touchDragData = null;
  });
});

// Add to cart buttons (fallback)
document.querySelectorAll('.print-card-btn').forEach(btn => {
  btn.addEventListener('click', e => {
    e.stopPropagation();
    const card = btn.closest('.print-card');
    addToCart(card.dataset.id, card.dataset.title, card.dataset.price);
  });
});

// Mobile cart toggle
cartToggle.addEventListener('click', () => {
  cartZone.classList.toggle('mobile-open');
});

// Stripe checkout mock
cartCheckout.addEventListener('click', () => {
  /* 
    STRIPE INTEGRATION:
    Replace with your real Stripe checkout:
    
    const stripe = Stripe('pk_live_YOUR_KEY');
    stripe.redirectToCheckout({
      lineItems: cart.map(item => ({
        price: item.stripePriceId,
        quantity: 1
      })),
      mode: 'payment',
      successUrl: window.location.origin + '/success.html',
      cancelUrl: window.location.href,
      billingAddressCollection: 'required',
      shippingAddressCollection: { allowedCountries: ['PT', 'ES', 'FR', 'DE', 'IT', 'NL', 'BE'] }
    });
  */
  alert('Stripe Checkout would open here.\n\nCart:\n' + cart.map(i => `${i.title} — €${i.price}`).join('\n') + '\n\nTotal: €' + cart.reduce((s,i) => s + i.price, 0));
});
</script>

</body>
</html>
