<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Broadcast Table</title>
<style>
* {
	margin: 0;
	padding: 0;
	box-sizing: border-box;
}

body {
	background: #0a0a0a;
	font-family: 'Arial', sans-serif;
	overflow: hidden;
	position: relative;
	height: 100vh;
	display: flex;
	align-items: center;
	justify-content: center;
}

/* Unified Broadcast Unit */
.broadcast-unit {
	background: #1a1a1a;
	border-radius: 15px;
	padding: 30px;
	box-shadow: 0 10px 40px rgba(0,0,0,0.5);
	position: relative;
	max-width: 95vw;
	margin: 0 auto;
	display: flex;
	gap: 30px;
}

/* Left Side - Two panels side by side */
.left-side {
	display: flex;
	gap: 15px;
}

/* Side Panels - SDI Connections */
.side-panel {
	display: flex;
	flex-direction: column;
	gap: 15px;
	padding: 20px;
	background: #222;
	border-radius: 10px;
	min-width: 100px;
}

.panel-label {
	text-align: center;
	color: #666;
	font-size: 10px;
	margin-bottom: 10px;
	text-transform: uppercase;
	letter-spacing: 1px;
}

.sdi-port {
	width: 50px;
	height: 50px;
	background: radial-gradient(circle, #2a2a2a 40%, #1a1a1a 100%);
	border: 3px solid #444;
	border-radius: 50%;
	position: relative;
	cursor: pointer;
	transition: all 0.2s;
	margin: 0 auto;
}

.sdi-port::before {
	content: '';
	position: absolute;
	top: 50%;
	left: 50%;
	transform: translate(-50%, -50%);
	width: 18px;
	height: 18px;
	background: #000;
	border-radius: 50%;
}

.sdi-port::after {
	position: absolute;
	top: 50%;
	color: #666;
	font-size: 9px;
	white-space: nowrap;
}

.output-panel .sdi-port::after {
	content: 'OUT ' attr(data-label);
	left: 60px;
	transform: translateY(-50%);
}

.input-panel .sdi-port::after {
	content: 'IN ' attr(data-label);
	left: 60px;
	transform: translateY(-50%);
}

.sdi-port.connected {
	border-color: #666;
	background: radial-gradient(circle, #2a2a2a 40%, #1a1a1a 100%);
}

/* Main Content */
.main-content {
	flex: 1;
	display: flex;
	flex-direction: column;
}

/* Monitor Section */
.monitor-section {
	width: 100%;
	margin-bottom: 20px;
	padding-bottom: 20px;
	border-bottom: 2px solid #333;
}

.monitor {
	background: #111;
	border: 2px solid #333;
	border-radius: 5px;
	padding: 8px;
	width: 100%;
}

.monitor-screen {
	width: 100%;
	background: #000;
	border-radius: 3px;
	position: relative;
	display: flex;
	flex-direction: column;
	gap: 3px;
}

.monitor-screen.maximized {
	gap: 2px;
}

/* Output Row - Preview and Program with 16:9 */
.output-row {
	display: grid;
	grid-template-columns: 1fr 1fr;
	gap: 3px;
}

.output-row.maximized {
	grid-template-columns: 1fr;
}

.output-feed {
	position: relative;
	width: 100%;
	padding-bottom: 56.25%; /* 16:9 Aspect Ratio */
	background: #000;
	border: 1px solid #222;
}

.output-feed .video-container {
	position: absolute;
	top: 0;
	left: 0;
	width: 100%;
	height: 100%;
	overflow: hidden;
}

/* Source Rows - 8 inputs with 16:9 */
.source-row {
	display: grid;
	grid-template-columns: repeat(4, 1fr);
	gap: 3px;
}

.source-row.maximized {
	display: grid;
	grid-template-columns: repeat(9, 1fr);
	gap: 2px;
}

.source-feed {
	position: relative;
	width: 100%;
	padding-bottom: 56.25%; /* 16:9 Aspect Ratio */
	background: #000;
	border: 1px solid #222;
}

.source-feed .video-container {
	position: absolute;
	top: 0;
	left: 0;
	width: 100%;
	height: 100%;
	overflow: hidden;
	background: #000;
}

.video-container video {
	width: 100%;
	height: 100%;
	object-fit: cover;
	display: block;
}

.video-container::before {
	content: attr(data-channel);
	position: absolute;
	top: 2px;
	left: 2px;
	background: rgba(0, 0, 0, 0.8);
	color: #0f0;
	padding: 2px 5px;
	font-size: 8px;
	font-family: monospace;
	z-index: 10;
	border-radius: 2px;
}

.output-feed.preview {
	border: 2px solid #ff0;
}

.output-feed.preview .video-container::before {
	color: #ff0;
	background: rgba(0, 0, 0, 0.9);
}

.output-feed.program {
	border: 2px solid #f00;
}

.output-feed.program .video-container::before {
	color: #f00;
	background: rgba(0, 0, 0, 0.9);
}

.source-feed.selected-preview {
	border: 2px solid #0f0;
}

.source-feed.selected-program {
	border: 2px solid #f00;
}

.monitor-label {
	text-align: center;
	color: #666;
	font-size: 10px;
	margin-top: 5px;
}

/* Main Grid */
.grid-section {
	background: #222;
	padding: 15px;
	border-radius: 8px;
}

.grid {
	display: grid;
	grid-template-columns: repeat(22, minmax(50px, 1fr));
	grid-template-rows: repeat(4, minmax(50px, 1fr));
	gap: 0.1rem;
	width: 100%;
}

.grid > div {
	aspect-ratio: 1/1;
}

.grid > div > button {
	width: 100%;
	height: 100%;
	border: none;
	border-radius: 3px;
	font-size: 8px;
	font-weight: bold;
	transition: all 0.1s;
	position: relative;
	overflow: hidden;
}

/* Screen buttons (no class) */
.grid > div > button:not(.off) {
	background: #113;
	cursor: default;
	border: 1px solid #003;
}

/* Off buttons (clickable) - dark gray by default */
.grid > div > button.off {
	background: #444;
	cursor: pointer;
	border: 1px solid #333;
	color: #ccc;
}

.grid > div > button.off:hover {
	background: #555;
}

/* Program buttons - red when active, white text */
.grid > div > button.off.program-btn.active {
	background: #f00;
	color: #fff;
	box-shadow: 0 0 10px rgba(255, 0, 0, 0.5);
}

/* Preview buttons - green when active, black text */
.grid > div > button.off.preview-btn.active {
	background: #0f0;
	color: #000;
	box-shadow: 0 0 10px rgba(0, 255, 0, 0.5);
}

/* Other buttons - white when active */
.grid > div > button.off.active:not(.program-btn):not(.preview-btn) {
	background: #fff;
	color: #000;
	box-shadow: inset 0 0 5px rgba(0,0,0,0.3);
}

/* Cable system - simple green cables */
.cable-svg {
	width: 100vw;
	height: 100vh;
	position: fixed;
	top: 0;
	left: 0;
	pointer-events: none;
	z-index: 5;
}

.cable-path {
	fill: none;
	stroke: #0f0;
	stroke-width: 5;
	stroke-linecap: round;
}

.cable-connector {
	position: absolute;
	width: 40px;
	height: 24px;
	cursor: grab;
	z-index: 100;
	background: linear-gradient(90deg, #444 0%, #666 50%, #444 100%);
	border: 1px solid #222;
	border-radius: 3px;
	box-shadow: 0 0 8px #0f0;
}

.cable-connector:active {
	cursor: grabbing;
}

.cable-connector.dragging {
	z-index: 1000;
}

</style>
</head>
<body>

<!-- Simple cable system -->
<svg class="cable-svg">
	<path class="cable-path" id="cable-1" d=""></path>
	<path class="cable-path" id="cable-2" d=""></path>
	<path class="cable-path" id="cable-3" d=""></path>
	<path class="cable-path" id="cable-4" d=""></path>
	<path class="cable-path" id="cable-5" d=""></path>
	<path class="cable-path" id="cable-6" d=""></path>
	<path class="cable-path" id="cable-7" d=""></path>
	<path class="cable-path" id="cable-8" d=""></path>
</svg>

<div class="cable-connector" data-cable="1" data-output="1"></div>
<div class="cable-connector" data-cable="2" data-output="2"></div>
<div class="cable-connector" data-cable="3" data-output="3"></div>
<div class="cable-connector" data-cable="4" data-output="4"></div>
<div class="cable-connector" data-cable="5" data-output="5"></div>
<div class="cable-connector" data-cable="6" data-output="6"></div>
<div class="cable-connector" data-cable="7" data-output="7"></div>
<div class="cable-connector" data-cable="8" data-output="8"></div>

<!-- Unified Broadcast Unit -->
<div class="broadcast-unit">
	<!-- Left Side - Output and Input panels side by side -->
	<div class="left-side">
		<!-- Output Panel -->
		<div class="side-panel output-panel">
			<div class="panel-label">Outputs</div>
			<div class="sdi-port connected" data-label="1" data-output="1" data-type="output"></div>
			<div class="sdi-port connected" data-label="2" data-output="2" data-type="output"></div>
			<div class="sdi-port connected" data-label="3" data-output="3" data-type="output"></div>
			<div class="sdi-port connected" data-label="4" data-output="4" data-type="output"></div>
			<div class="sdi-port connected" data-label="5" data-output="5" data-type="output"></div>
			<div class="sdi-port connected" data-label="6" data-output="6" data-type="output"></div>
			<div class="sdi-port connected" data-label="7" data-output="7" data-type="output"></div>
			<div class="sdi-port connected" data-label="8" data-output="8" data-type="output"></div>
		</div>

		<!-- Input Panel -->
		<div class="side-panel input-panel">
			<div class="panel-label">Inputs</div>
			<div class="sdi-port connected" data-label="1" data-input="1" data-type="input"></div>
			<div class="sdi-port connected" data-label="2" data-input="2" data-type="input"></div>
			<div class="sdi-port connected" data-label="3" data-input="3" data-type="input"></div>
			<div class="sdi-port connected" data-label="4" data-input="4" data-type="input"></div>
			<div class="sdi-port connected" data-label="5" data-input="5" data-type="input"></div>
			<div class="sdi-port connected" data-label="6" data-input="6" data-type="input"></div>
			<div class="sdi-port connected" data-label="7" data-input="7" data-type="input"></div>
			<div class="sdi-port connected" data-label="8" data-input="8" data-type="input"></div>
		</div>
	</div>
	
	<!-- Main Content -->
	<div class="main-content">
		<!-- Monitor Section -->
		<div class="monitor-section">
			<div class="monitor">
				<div class="monitor-screen" id="monitor-screen">
					<!-- Output Row - Preview and Program -->
					<div class="output-row" id="output-row">
						<div class="output-feed preview" id="preview-feed">
							<div class="video-container" data-channel="PREVIEW">
								<video id="preview-video" loop muted preload="auto">
									<source src="" type="video/mp4">
								</video>
							</div>
						</div>
						<div class="output-feed program" id="program-feed">
							<div class="video-container" data-channel="PROGRAM">
								<video id="program-video" loop muted preload="auto">
									<source src="" type="video/mp4">
								</video>
							</div>
						</div>
					</div>
					<!-- Source Rows -->
					<div id="source-container">
						<!-- Source Row 1 -->
						<div class="source-row">
							<div class="source-feed" data-source="1">
								<div class="video-container" data-channel="IN 1">
									<video loop muted preload="auto">
										<source src="" type="video/mp4">
									</video>
								</div>
							</div>
							<div class="source-feed" data-source="2">
								<div class="video-container" data-channel="IN 2">
									<video loop muted preload="auto">
										<source src="" type="video/mp4">
									</video>
								</div>
							</div>
							<div class="source-feed" data-source="3">
								<div class="video-container" data-channel="IN 3">
									<video loop muted preload="auto">
										<source src="" type="video/mp4">
									</video>
								</div>
							</div>
							<div class="source-feed" data-source="4">
								<div class="video-container" data-channel="IN 4">
									<video loop muted preload="auto">
										<source src="" type="video/mp4">
									</video>
								</div>
							</div>
						</div>
						<!-- Source Row 2 -->
						<div class="source-row">
							<div class="source-feed" data-source="5">
								<div class="video-container" data-channel="IN 5">
									<video loop muted preload="auto">
										<source src="" type="video/mp4">
									</video>
								</div>
							</div>
							<div class="source-feed" data-source="6">
								<div class="video-container" data-channel="IN 6">
									<video loop muted preload="auto">
										<source src="" type="video/mp4">
									</video>
								</div>
							</div>
							<div class="source-feed" data-source="7">
								<div class="video-container" data-channel="IN 7">
									<video loop muted preload="auto">
										<source src="" type="video/mp4">
									</video>
								</div>
							</div>
							<div class="source-feed" data-source="8">
								<div class="video-container" data-channel="IN 8">
									<video loop muted preload="auto">
										<source src="" type="video/mp4">
									</video>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="monitor-label">MULTIVIEW - BROADCAST SWITCHER</div>
		</div>
		
		<!-- Grid Section -->
		<div class="grid-section">
			<div class="grid">
				<!-- Row 1 - Program Control -->
				<div><button class="off program-btn" data-source="1">1</button></div>
				<div><button class="off program-btn" data-source="2">2</button></div>
				<div><button class="off program-btn" data-source="3">3</button></div>
				<div><button class="off program-btn" data-source="4">4</button></div>
				<div><button class="off program-btn" data-source="5">5</button></div>
				<div><button class="off program-btn" data-source="6">6</button></div>
				<div><button class="off program-btn" data-source="7">7</button></div>
				<div><button class="off program-btn" data-source="8">8</button></div>
				<div><button class="off">9</button></div>
				<div><button class="off">10</button></div>
				<div></div>
				<div><button class="off" id="view-toggle-btn">MAXIMIZE</button></div>
				<div></div>
				<div><button class="off">DIP</button></div>
				<div><button class="off">DVE</button></div>
				<div><button class="off">STING</button></div>
				<div></div>
				<div></div>
				<div><button class="off">A</button></div>
				<div><button class="off">A</button></div>
				<div></div>
				<div></div>

				<!-- Row 2 - Screens -->
				<div><button class=""></button></div>
				<div><button class=""></button></div>
				<div><button class=""></button></div>
				<div><button class=""></button></div>
				<div><button class=""></button></div>
				<div><button class=""></button></div>
				<div><button class=""></button></div>
				<div><button class=""></button></div>
				<div><button class=""></button></div>
				<div><button class=""></button></div>
				<div></div>
				<div></div>
				<div></div>
				<div><button class="off">MIX</button></div>
				<div><button class="off">WIPE</button></div>
				<div><button class="off">ARM</button></div>
				<div></div>
				<div></div>
				<div></div>
				<div></div>
				<div></div>
				<div></div>

				<!-- Row 3 - Preview Control -->
				<div><button class="off preview-btn" data-source="1">1</button></div>
				<div><button class="off preview-btn" data-source="2">2</button></div>
				<div><button class="off preview-btn" data-source="3">3</button></div>
				<div><button class="off preview-btn" data-source="4">4</button></div>
				<div><button class="off preview-btn" data-source="5">5</button></div>
				<div><button class="off preview-btn" data-source="6">6</button></div>
				<div><button class="off preview-btn" data-source="7">7</button></div>
				<div><button class="off preview-btn" data-source="8">8</button></div>
				<div><button class="off">9</button></div>
				<div><button class="off">10</button></div>
				<div></div>
				<div></div>
				<div></div>
				<div></div>
				<div></div>
				<div></div>
				<div></div>
				<div></div>
				<div><button class="off">A</button></div>
				<div><button class="off">A</button></div>
				<div></div>
				<div></div>

				<!-- Row 4 - Screens -->
				<div><button class=""></button></div>
				<div><button class=""></button></div>
				<div><button class=""></button></div>
				<div><button class=""></button></div>
				<div><button class=""></button></div>
				<div><button class=""></button></div>
				<div><button class=""></button></div>
				<div><button class=""></button></div>
				<div><button class=""></button></div>
				<div><button class=""></button></div>
				<div></div>
				<div></div>
				<div></div>
				<div><button class="off">CUT</button></div>
				<div></div>
				<div><button class="off">AUTO</button></div>
				<div></div>
				<div></div>
				<div><button class="off">A</button></div>
				<div><button class="off">A</button></div>
				<div></div>
				<div><button class="off">FTB</button></div>
			</div>
		</div>
	</div>
</div>

<audio id="keySound" preload="auto">
	<source src="key.wav" type="audio/wav">
</audio>

<audio id="plugSound" preload="auto">
	<source src="plug.wav" type="audio/wav">
</audio>

<script>
// Get elements - keeping your original working code
const programButtons = document.querySelectorAll('.program-btn');
const previewButtons = document.querySelectorAll('.preview-btn');
const keySound = document.getElementById('keySound');
const plugSound = document.getElementById('plugSound');
const viewToggleBtn = document.getElementById('view-toggle-btn');
const outputRow = document.getElementById('output-row');
const sourceContainer = document.getElementById('source-container');
const previewFeed = document.getElementById('preview-feed');
const programFeed = document.getElementById('program-feed');

// Current state
let previewSource = null;
let programSource = null;
let isMaximized = false;

// Cable system - simple addition
const cableConnections = {}; // input -> output mapping

// Get video source for an input based on cable connections
function getVideoForInput(inputNum) {
	const outputNum = cableConnections[inputNum];
	return outputNum ? `video${outputNum}.mp4` : null;
}

// Update all monitor screens based on current cable connections
function updateAllMonitorScreens() {
	// Update source screens 1-8
	for (let i = 1; i <= 8; i++) {
		const sourceFeed = document.querySelector(`.source-feed[data-source="${i}"]`);
		if (sourceFeed) {
			const video = sourceFeed.querySelector('video');
			const videoSrc = getVideoForInput(i);
			
			if (videoSrc) {
				video.src = videoSrc;
				video.load();
				video.play().catch(e => console.log('Video play failed'));
			} else {
				video.pause();
				video.src = '';
			}
		}
	}
	
	// Update preview and program if they're selected
	if (previewSource) {
		updatePreview(previewSource);
	}
	if (programSource) {
		updateProgram(programSource);
	}
}
// Get current preview and program video elements
function getPreviewVideo() {
	let previewVideo = document.getElementById('preview-video-max');
	if (!previewVideo) {
		previewVideo = document.getElementById('preview-video');
	}
	return previewVideo;
}

function getProgramVideo() {
	return document.getElementById('program-video');
}

// Update preview video based on cable routing
function updatePreview(inputNum) {
	const previewVideo = getPreviewVideo();
	if (previewVideo) {
		const videoSrc = getVideoForInput(inputNum);
		if (videoSrc) {
			previewVideo.src = videoSrc;
			previewVideo.load();
			previewVideo.play().catch(e => console.log('Preview play failed'));
		} else {
			previewVideo.pause();
			previewVideo.src = '';
		}
	}
}

// Update program video based on cable routing
function updateProgram(inputNum) {
	const programVideo = getProgramVideo();
	if (programVideo) {
		const videoSrc = getVideoForInput(inputNum);
		if (videoSrc) {
			programVideo.src = videoSrc;
			programVideo.load();
			programVideo.play().catch(e => console.log('Program play failed'));
		} else {
			programVideo.pause();
			programVideo.src = '';
		}
	}
}

// Clear preview
function clearPreview() {
	const previewVideo = getPreviewVideo();
	if (previewVideo) {
		previewVideo.pause();
		previewVideo.src = '';
	}
}

// Clear program
function clearProgram() {
	const programVideo = getProgramVideo();
	if (programVideo) {
		programVideo.pause();
		programVideo.src = '';
	}
}

// Update source highlights
function updateSourceHighlights() {
	document.querySelectorAll('.source-feed').forEach(feed => {
		feed.classList.remove('selected-preview', 'selected-program');
	});
	
	if (previewSource) {
		const selectedFeed = document.querySelector(`.source-feed[data-source="${previewSource}"]`);
		if (selectedFeed) selectedFeed.classList.add('selected-preview');
	}
	if (programSource) {
		const selectedFeed = document.querySelector(`.source-feed[data-source="${programSource}"]`);
		if (selectedFeed) selectedFeed.classList.add('selected-program');
	}
}

// Program buttons - your original working code
programButtons.forEach(button => {
	button.addEventListener('click', function() {
		const sourceNum = parseInt(this.dataset.source);
		
		try {
			keySound.currentTime = 0;
			keySound.play().catch(e => console.log('Audio play failed:', e));
		} catch(e) {}

		if (this.classList.contains('active') && programSource === sourceNum) {
			programButtons.forEach(btn => btn.classList.remove('active'));
			programSource = null;
			clearProgram();
		} else {
			programButtons.forEach(btn => btn.classList.remove('active'));
			this.classList.add('active');
			programSource = sourceNum;
			updateProgram(sourceNum);
		}
		
		updateSourceHighlights();
	});
});

// Preview buttons - your original working code
previewButtons.forEach(button => {
	button.addEventListener('click', function() {
		const sourceNum = parseInt(this.dataset.source);
		
		try {
			keySound.currentTime = 0;
			keySound.play().catch(e => console.log('Audio play failed:', e));
		} catch(e) {}

		if (this.classList.contains('active') && previewSource === sourceNum) {
			previewButtons.forEach(btn => btn.classList.remove('active'));
			previewSource = null;
			clearPreview();
		} else {
			previewButtons.forEach(btn => btn.classList.remove('active'));
			this.classList.add('active');
			previewSource = sourceNum;
			updatePreview(sourceNum);
		}
		
		updateSourceHighlights();
	});
});

// View toggle - your original working code
viewToggleBtn.addEventListener('click', function() {
	try {
		keySound.currentTime = 0;
		keySound.play().catch(e => console.log('Audio play failed:', e));
	} catch(e) {}
	
	if (!isMaximized) {
		isMaximized = true;
		this.classList.add('active');
		this.textContent = 'MINIMIZE';
		
		outputRow.classList.add('maximized');
		previewFeed.style.display = 'none';
		
		const previewSrc = previewSource ? `video${previewSource}.mp4` : '';
		
		sourceContainer.innerHTML = `
			<div class="source-row maximized">
				<div class="output-feed preview" style="padding-bottom: 56.25%;">
					<div class="video-container" data-channel="PREVIEW">
						<video id="preview-video-max" loop muted preload="auto">
							<source src="" type="video/mp4">
						</video>
					</div>
				</div>
				${[1,2,3,4,5,6,7,8].map(i => {
					const videoSrc = getVideoForInput(i);
					return `
					<div class="source-feed" data-source="${i}">
						<div class="video-container" data-channel="IN ${i}">
							<video loop muted preload="auto">
								<source src="${videoSrc || ''}" type="video/mp4">
							</video>
						</div>
					</div>
				`;}).join('')}
			</div>
		`;
		
		const newPreviewVideo = document.getElementById('preview-video-max');
		if (newPreviewVideo && previewSource) {
			newPreviewVideo.src = `video${previewSource}.mp4`;
			newPreviewVideo.load();
			newPreviewVideo.play().catch(e => console.log('Preview play failed'));
		}
		
		sourceContainer.querySelectorAll('video').forEach(video => {
			video.play().catch(e => console.log('Video play failed'));
		});
		
		updateSourceHighlights();
		
	} else {
		isMaximized = false;
		this.classList.remove('active');
		this.textContent = 'MAXIMIZE';
		
		outputRow.classList.remove('maximized');
		previewFeed.style.display = '';
		
		sourceContainer.innerHTML = `
			<div class="source-row">
				${[1,2,3,4].map(i => {
					const videoSrc = getVideoForInput(i);
					return `
					<div class="source-feed" data-source="${i}">
						<div class="video-container" data-channel="IN ${i}">
							<video loop muted preload="auto">
								<source src="${videoSrc || ''}" type="video/mp4">
							</video>
						</div>
					</div>
				`;}).join('')}
			</div>
			<div class="source-row">
				${[5,6,7,8].map(i => {
					const videoSrc = getVideoForInput(i);
					return `
					<div class="source-feed" data-source="${i}">
						<div class="video-container" data-channel="IN ${i}">
							<video loop muted preload="auto">
								<source src="${videoSrc || ''}" type="video/mp4">
							</video>
						</div>
					</div>
				`;}).join('')}
			</div>
		`;
		
		sourceContainer.querySelectorAll('video').forEach(video => {
			video.play().catch(e => console.log('Video play failed'));
		});
		
		if (previewSource) updatePreview(previewSource);
		if (programSource) updateProgram(programSource);
		
		updateSourceHighlights();
	}
});

// Other buttons - your original working code
document.querySelectorAll('.grid button.off').forEach(button => {
	if (!button.classList.contains('program-btn') && 
		!button.classList.contains('preview-btn') && 
		button.id !== 'view-toggle-btn') {
		button.addEventListener('click', function() {
			try {
				keySound.currentTime = 0;
				keySound.play().catch(e => console.log('Audio play failed:', e));
			} catch(e) {}
			
			this.classList.toggle('active');
		});
	}
});

// Simple cable dragging - minimal addition
function initCables() {
	const connectors = document.querySelectorAll('.cable-connector');
	const inputPorts = document.querySelectorAll('.sdi-port[data-type="input"]');
	
	// Initialize with outputs connected to their respective inputs
	for (let i = 1; i <= 8; i++) {
		cableConnections[i] = i; // input 1 -> output 1, etc.
	}
	
	connectors.forEach(connector => {
		const cableNum = connector.dataset.cable;
		const outputNum = connector.dataset.output;
		
		// Position at corresponding input port initially
		const inputPort = document.querySelector(`.sdi-port[data-input="${outputNum}"]`);
		if (inputPort) {
			const rect = inputPort.getBoundingClientRect();
			connector.style.left = (rect.left + 25 - 20) + 'px';
			connector.style.top = (rect.top + 25 - 12) + 'px';
			
			// Draw initial cable path
			const outputPort = document.querySelector(`.sdi-port[data-output="${outputNum}"]`);
			if (outputPort) {
				const outputRect = outputPort.getBoundingClientRect();
				const startX = outputRect.left + 25;
				const startY = outputRect.top + 25;
				const endX = rect.left + 25;
				const endY = rect.top + 25;
				
				const path = document.getElementById(`cable-${cableNum}`);
				const d = `M ${startX} ${startY} Q ${(startX + endX) / 2} ${startY} ${endX} ${endY}`;
				path.setAttribute('d', d);
			}
		}
		
		let isDragging = false;
		let offset = {x: 0, y: 0};
		
		connector.addEventListener('mousedown', function(e) {
			isDragging = true;
			this.classList.add('dragging');
			const rect = this.getBoundingClientRect();
			offset.x = e.clientX - rect.left;
			offset.y = e.clientY - rect.top;
			e.preventDefault();
		});
		
		document.addEventListener('mousemove', function(e) {
			if (isDragging) {
				const x = e.clientX - offset.x;
				const y = e.clientY - offset.y;
				
				connector.style.left = x + 'px';
				connector.style.top = y + 'px';
				
				// Update cable path
				const outputPort = document.querySelector(`.sdi-port[data-output="${outputNum}"]`);
				if (outputPort) {
					const outputRect = outputPort.getBoundingClientRect();
					const startX = outputRect.left + 25;
					const startY = outputRect.top + 25;
					const endX = x + 20;
					const endY = y + 12;
					
					const path = document.getElementById(`cable-${cableNum}`);
					const d = `M ${startX} ${startY} Q ${(startX + endX) / 2} ${startY} ${endX} ${endY}`;
					path.setAttribute('d', d);
				}
			}
		});
		
		document.addEventListener('mouseup', function(e) {
			if (isDragging) {
				isDragging = false;
				connector.classList.remove('dragging');
				
				const x = e.clientX - offset.x;
				const y = e.clientY - offset.y;
				let connected = false;
				
				// Check for connection to input
				inputPorts.forEach(port => {
					const rect = port.getBoundingClientRect();
					const dist = Math.sqrt((x + 20 - rect.left - 25) ** 2 + (y + 12 - rect.top - 25) ** 2);
					
					if (dist < 30) {
						const inputNum = port.dataset.input;
						
						// Remove old connection for this output
						Object.keys(cableConnections).forEach(input => {
							if (cableConnections[input] === outputNum) {
								delete cableConnections[input];
								const oldPort = document.querySelector(`.sdi-port[data-input="${input}"]`);
								if (oldPort) oldPort.classList.remove('connected');
							}
						});
						
						// Remove any existing connection to this input
						if (cableConnections[inputNum]) {
							delete cableConnections[inputNum];
						}
						
						// Make new connection
						cableConnections[inputNum] = outputNum;
						port.classList.add('connected');
						
						// Update all monitor screens since routing changed
						updateAllMonitorScreens();
						
						// Snap to port
						connector.style.left = (rect.left + 25 - 20) + 'px';
						connector.style.top = (rect.top + 25 - 12) + 'px';
						
						// Update cable path
						const outputPort = document.querySelector(`.sdi-port[data-output="${outputNum}"]`);
						if (outputPort) {
							const outputRect = outputPort.getBoundingClientRect();
							const startX = outputRect.left + 25;
							const startY = outputRect.top + 25;
							const endX = rect.left + 25;
							const endY = rect.top + 25;
							
							const path = document.getElementById(`cable-${cableNum}`);
							const d = `M ${startX} ${startY} Q ${(startX + endX) / 2} ${startY} ${endX} ${endY}`;
							path.setAttribute('d', d);
						}
						
						connected = true;
						
						// Play plug sound
						try {
							plugSound.currentTime = 0;
							plugSound.play().catch(e => console.log('Plug sound failed'));
						} catch(e) {}
					}
				});
				
				// Spring back if not connected
				if (!connected) {
					// Remove old connection
					Object.keys(cableConnections).forEach(input => {
						if (cableConnections[input] === outputNum) {
							delete cableConnections[input];
							const oldPort = document.querySelector(`.sdi-port[data-input="${input}"]`);
							if (oldPort) oldPort.classList.remove('connected');
							
							// Play unplug sound
							try {
								plugSound.currentTime = 0;
								plugSound.play().catch(e => console.log('Plug sound failed'));
							} catch(e) {}
						}
					});
					
					const outputPort = document.querySelector(`.sdi-port[data-output="${outputNum}"]`);
					if (outputPort) {
						const rect = outputPort.getBoundingClientRect();
						connector.style.transition = 'all 0.3s ease';
						connector.style.left = (rect.left + 25 - 20) + 'px';
						connector.style.top = (rect.top + 25 - 12) + 'px';
						
						setTimeout(() => {
							connector.style.transition = '';
							document.getElementById(`cable-${cableNum}`).setAttribute('d', '');
						}, 300);
					}
				}
			}
		});
	});
}

// Auto-play videos and initialize cables
document.addEventListener('DOMContentLoaded', function() {
	document.querySelectorAll('.source-feed video').forEach(video => {
		video.play().catch(e => console.log('Video autoplay failed'));
	});
	
	setTimeout(initCables, 100);
});
</script>
</body>
</html>